---
- name: Remove image and container
  block:
  - name: Remove container
    docker_container:
      name: "{{ name }}"
      image: "{{ username }}/{{ image_name }}:{{ tag }}"
      published_ports: "{{ ports }}"
      state: absent

  - name: Remove image
    docker_image:
      repository: "{{ username }}"
      name: "{{ image_name }}"
      tag: "{{ tag }}"
      state: absent

  when: web_app_full_wipe | bool
  tags:
    - wipe
